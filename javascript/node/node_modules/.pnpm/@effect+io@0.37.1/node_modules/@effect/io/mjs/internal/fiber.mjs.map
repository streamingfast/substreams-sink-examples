{"version":3,"file":"fiber.mjs","names":["Either","dual","HashSet","number","Option","order","pipeArguments","Clock","Exit","FiberId","FiberStatus","core","fiberScope","runtimeFlags","FiberSymbolKey","FiberTypeId","Symbol","for","fiberVariance","_E","_","_A","fiberProto","pipe","arguments","RuntimeFiberSymbolKey","RuntimeFiberTypeId","Order","mapInput","fiber","id","startTimeMillis","tuple","isFiber","u","isRuntimeFiber","self","_await","await","children","done","exit","none","succeed","inheritAll","unit","poll","some","interruptAsFork","dump","map","status","dumpAll","fibers","forEachSequential","fail","error","failCause","cause","fromEffect","effect","interrupted","fiberId","interrupt","interruptAll","flatMap","interruptAllAs","zipRight","forEachSequentialDiscard","join","zipLeft","flatten","f","mapEffect","a","sync","forEachEffect","result","_tag","value","mapFiber","match","onFailure","onSuccess","onFiber","onRuntimeFiber","never","orElse","that","getOrElse","zipWith","exit1","exit2","isSuccess","option1","option2","asUnit","interruptAsFiber","orElseEither","left","right","parseMs","milliseconds","roundTowardsZero","Math","floor","ceil","days","hours","minutes","seconds","microseconds","nanoseconds","renderStatus","isDone","isRunning","isInterruptible","interruptible","pretty","currentTimeMillis","now","time","lifeMsg","waitMsg","isSuspended","ids","blockingOn","size","Array","from","statusMsg","unsafeRoots","globalScope","roots","currentFiberURI","getCurrentFiber","fromNullable","globalThis"],"sources":["../../src/internal/fiber.ts"],"sourcesContent":[null],"mappings":"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"}