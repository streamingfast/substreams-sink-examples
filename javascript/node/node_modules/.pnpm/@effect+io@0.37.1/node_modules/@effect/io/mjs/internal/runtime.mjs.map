{"version":3,"file":"runtime.mjs","names":["Context","Option","pipeArguments","Exit","Fiber","FiberId","FiberRefs","NoSuchElementException","CausePretty","core","FiberRuntime","fiberScope","OpCodes","runtimeFlags","_supervisor","_scheduler","unsafeFork","runtime","self","options","fiberId","unsafeMake","effect","fiberRefs","updatedAs","fiberRef","currentContext","value","context","scheduler","currentScheduler","updateRefs","fiberRuntime","forkAs","supervisor","none","onStart","unsafeAddObserver","exit","onEnd","globalScope","add","start","unsafeRunCallback","onExit","id","onExitInterrupt","interruptAs","flatten","unsafeRunSync","result","unsafeRunSyncExit","_tag","fiberFailure","i0","asyncFiberException","fiber","limit","Error","stackTraceLimit","error","message","Object","defineProperties","name","toString","get","NodePrint","isAsyncFiberException","u","FiberFailureId","Symbol","for","FiberFailureCauseId","cause","pretty","prettyErrors","length","split","substring","stack","isFiberFailure","fastPath","op","exitFail","left","exitSucceed","right","SyncScheduler","flush","unsafePoll","unsafeRunPromise","unsafeRunPromiseExit","then","OP_SUCCESS","OP_FAILURE","Promise","resolve","RuntimeImpl","constructor","pipe","arguments","make","flags","withFiberRuntime","state","status","succeed","getFiberRef","unsafeGetFiberRefs","defaultRuntimeFlags","Interruption","CooperativeYielding","RuntimeMetrics","defaultRuntime","empty","Map","unsafeRunEffect","unsafeForkEffect","unsafeRunPromiseEffect","unsafeRunPromiseExitEffect","unsafeRunSyncEffect","unsafeRunSyncExitEffect","asyncEffect","register","flatMap","deferredMake","deferred","uninterruptibleMask","restore","zipRight","fork","catchAllCause","cb","intoDeferred","deferredFailCause","deferredAwait"],"sources":["../../src/internal/runtime.ts"],"sourcesContent":[null],"mappings":"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"}